{% extends 'elections/base_edits.html' %}
{% load i18n %}

{% block content %}

<div class="fondo_formulario">

    <div class="numero_off uno">1.</div>
    <div class="numero_on dos">2.</div>
    <div class="numero_off tres">3.</div>
    <div class="numero_off cuatro">4.</div>
    <div class="numero_off cinco">5.</div>

    <h2>{% trans 'Candidatos' %}</h2>
    <div class="instrucciones">{% trans '¿Quiénes son los candidatos?' %}</div>
    <ul id="lista_candidatos">
        {% for candidate in election.candidate_set.all %}
        <li>
            <span class="tit_fondoverde">
                {% blocktrans with num=forloop.counter %}Candidato {{ num }}{% endblocktrans %}
            </span>
            &nbsp;{{ candidate.name }}
        </li>
        {% endfor %}
    </ul>
    <br/>

    <form id="newelection" method="POST" enctype="multipart/form-data">{% csrf_token %}
        {{ form.non_field_errors }}
        {{ form.as_p }}
        <a class="bt_siguiente" href="javascript:void(0);" onclick="document.forms['newelection'].submit();return false;">
           <img src="{{ STATIC_URL }}img/bt_siguiente.png"/>
        </a>
    </form>

    {% if election.candidate_set.count %}
    <div id="link_next">
        <a href="{% url personal_data_create election_slug=election.slug %}">{% trans "Siguiente (Datos Personales)" %}</a>
    </div>
    {% endif %}


{% endblock %}

{% block extra_js %}
    {{ form.media }}
    <script type="text/javascript">

        $(function () {
            $('#id_first_name, #id_last_name').keyup(function () {
                var first_name = $.trim($("#id_first_name").val());
                var last_name = $.trim($("#id_last_name").val());
                var value = "";
                if (first_name != '' || last_name != '') {
                    if (first_name != '' && last_name != '') {
                        value = first_name + '-' + last_name
                    }
                    else if (first_name == '') {
                        value = last_name
                    }
                    else if (last_name == '') {
                        value = first_name
                    }
                }
                $('#id_slug').val($.slug(value));
            });

            $('#id_personal_information_table tbody tr').formset({
                extraClasses:['row1', 'row2', 'row3']
            })
            $('#id_link_table tbody tr').formset({
                extraClasses:['row1', 'row2', 'row3']
            })
        });
    </script>
{% endblock %}